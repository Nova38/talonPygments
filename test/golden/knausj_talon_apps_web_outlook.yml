input: "# https://support.office.com/en-us/article/keyboard-shortcuts-for-outlook-3cdeb221-7ae5-4c1d-8c1d-9e63216c1efd#PickTab=Web\n\
  # the shortcuts below our based half of the bill in short cut menu, but the\n# link\
  \ above has significantly more that could so be added\n\nos: linux\ntag: browser\n\
  win.title: /Outlook/\n-\n\n# write email\nnew message: key(n)\nsend [this] message:\
  \ key(alt-s)\nreply [to] [this] message: key(r)\nreply all [to] [this] message:\
  \ key(ctrl-shift-r)\nforward [this] message: key(ctrl-shift-f)\nsave [draft]: key(ctrl-s)\n\
  discard [draft]: key(esc)\ninsert [a] [hyper] link: key(ctrl-k)\n\n# email list\n\
  (select|unselect) [this] message: key(ctrl-space)\nselect all [messages]: key(ctrl-a)\n\
  clear all [messages]: key(esc)\nselect first [message]: key(home)\nselect last [message]:\
  \ key(and)\n\n# read email\nopen [this] message: key(o)\nopen [this] message [in]\
  \ [a] new window: key(shift-enter)\nclose [this] message: key(esc)\n[open] [the]\
  \ next (item|message): key(ctrl-.)\n[open] [the] (prev|previous) item: key(ctrl-,)\n\
  next reading [pane] (item|message): key(.)\n(prev|previous) [pane] (item|message):\
  \ key(,)\n(expand|collapse) [conversation]: key(x)\n\n# go to\ngo [to] mail: key(ctrl-shift-1)\n\
  go [to] calendar: key(ctrl-shift-2)\ngo [to] people: key(ctrl-shift-3)\ngo [to]\
  \ to do: key(ctrl-shift-4)\ngo [to] inbox:\n    key(g)\n    key(i)\ngo to drafts:\n\
  \    key(g)\n    key(d)\ngo to sent:\n    key(g)\n    key(s)\nsearch [email]: key(alt-q)\n\
  show help: key(?)\n\n# email actions\nundo [last] [action]: key(ctrl-z)\ndelete\
  \ [this] [message]: key(delete)\n(perm|permanently) delete [this] [message]: key(shift+delete)\n\
  new folder: key(shift-e)\nmark [this] [(item|message)] as read: key(q)\nmark [this]\
  \ [(item|message)] as unread: key(u)\nflag [this] [(item|message)]: key(insert)\n\
  archive: key(e)\nmark [this] [message] [as] junk: key(j)\nmoved to [a] folder: key(v)\n\
  categorize [this] message: key(c)\n"
output:
  type: source_file
  children:
  - text: '# https://support.office.com/en-us/article/keyboard-shortcuts-for-outlook-3cdeb221-7ae5-4c1d-8c1d-9e63216c1efd#PickTab=Web'
    type: comment
  - text: '# the shortcuts below our based half of the bill in short cut menu, but
      the'
    type: comment
  - text: '# link above has significantly more that could so be added'
    type: comment
  - type: context
    children:
    - type: or
      children:
      - type: match
        key:
          text: os
          type: identifier
        pattern:
          text: ' linux'
          type: implicit_string
      - type: match
        key:
          text: tag
          type: identifier
        pattern:
          text: ' browser'
          type: implicit_string
      - type: match
        key:
          text: win.title
          type: identifier
        pattern:
          text: ' /Outlook/'
          type: implicit_string
  - text: '# write email'
    type: comment
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: new
          type: word
        - text: message
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: n
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: send
          type: word
        - type: optional
          children:
          - text: this
            type: word
        - text: message
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: alt-s
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: reply
          type: word
        - type: optional
          children:
          - text: to
            type: word
        - type: optional
          children:
          - text: this
            type: word
        - text: message
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: r
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: reply
          type: word
        - text: all
          type: word
        - type: optional
          children:
          - text: to
            type: word
        - type: optional
          children:
          - text: this
            type: word
        - text: message
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: ctrl-shift-r
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: forward
          type: word
        - type: optional
          children:
          - text: this
            type: word
        - text: message
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: ctrl-shift-f
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: save
          type: word
        - type: optional
          children:
          - text: draft
            type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: ctrl-s
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: discard
          type: word
        - type: optional
          children:
          - text: draft
            type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: esc
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: insert
          type: word
        - type: optional
          children:
          - text: a
            type: word
        - type: optional
          children:
          - text: hyper
            type: word
        - text: link
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: ctrl-k
            type: implicit_string
  - text: '# email list'
    type: comment
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - type: parenthesized_rule
          children:
          - type: choice
            children:
            - text: select
              type: word
            - text: unselect
              type: word
        - type: optional
          children:
          - text: this
            type: word
        - text: message
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: ctrl-space
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: select
          type: word
        - text: all
          type: word
        - type: optional
          children:
          - text: messages
            type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: ctrl-a
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: clear
          type: word
        - text: all
          type: word
        - type: optional
          children:
          - text: messages
            type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: esc
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: select
          type: word
        - text: first
          type: word
        - type: optional
          children:
          - text: message
            type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: home
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: select
          type: word
        - text: last
          type: word
        - type: optional
          children:
          - text: message
            type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: and
            type: implicit_string
  - text: '# read email'
    type: comment
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: open
          type: word
        - type: optional
          children:
          - text: this
            type: word
        - text: message
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: o
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: open
          type: word
        - type: optional
          children:
          - text: this
            type: word
        - text: message
          type: word
        - type: optional
          children:
          - text: in
            type: word
        - type: optional
          children:
          - text: a
            type: word
        - text: new
          type: word
        - text: window
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: shift-enter
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: close
          type: word
        - type: optional
          children:
          - text: this
            type: word
        - text: message
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: esc
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - type: optional
          children:
          - text: open
            type: word
        - type: optional
          children:
          - text: the
            type: word
        - text: next
          type: word
        - type: parenthesized_rule
          children:
          - type: choice
            children:
            - text: item
              type: word
            - text: message
              type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: ctrl-.
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - type: optional
          children:
          - text: open
            type: word
        - type: optional
          children:
          - text: the
            type: word
        - type: parenthesized_rule
          children:
          - type: choice
            children:
            - text: prev
              type: word
            - text: previous
              type: word
        - text: item
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: ctrl-,
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: next
          type: word
        - text: reading
          type: word
        - type: optional
          children:
          - text: pane
            type: word
        - type: parenthesized_rule
          children:
          - type: choice
            children:
            - text: item
              type: word
            - text: message
              type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: .
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - type: parenthesized_rule
          children:
          - type: choice
            children:
            - text: prev
              type: word
            - text: previous
              type: word
        - type: optional
          children:
          - text: pane
            type: word
        - type: parenthesized_rule
          children:
          - type: choice
            children:
            - text: item
              type: word
            - text: message
              type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: ','
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - type: parenthesized_rule
          children:
          - type: choice
            children:
            - text: expand
              type: word
            - text: collapse
              type: word
        - type: optional
          children:
          - text: conversation
            type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: x
            type: implicit_string
  - text: '# go to'
    type: comment
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: go
          type: word
        - type: optional
          children:
          - text: to
            type: word
        - text: mail
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: ctrl-shift-1
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: go
          type: word
        - type: optional
          children:
          - text: to
            type: word
        - text: calendar
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: ctrl-shift-2
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: go
          type: word
        - type: optional
          children:
          - text: to
            type: word
        - text: people
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: ctrl-shift-3
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: go
          type: word
        - type: optional
          children:
          - text: to
            type: word
        - text: to
          type: word
        - text: do
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: ctrl-shift-4
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: go
          type: word
        - type: optional
          children:
          - text: to
            type: word
        - text: inbox
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: g
            type: implicit_string
      - type: expression
        expression:
          type: key_action
          arguments:
            text: i
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: go
          type: word
        - text: to
          type: word
        - text: drafts
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: g
            type: implicit_string
      - type: expression
        expression:
          type: key_action
          arguments:
            text: d
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: go
          type: word
        - text: to
          type: word
        - text: sent
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: g
            type: implicit_string
      - type: expression
        expression:
          type: key_action
          arguments:
            text: s
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: search
          type: word
        - type: optional
          children:
          - text: email
            type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: alt-q
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: show
          type: word
        - text: help
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: '?'
            type: implicit_string
  - text: '# email actions'
    type: comment
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: undo
          type: word
        - type: optional
          children:
          - text: last
            type: word
        - type: optional
          children:
          - text: action
            type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: ctrl-z
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: delete
          type: word
        - type: optional
          children:
          - text: this
            type: word
        - type: optional
          children:
          - text: message
            type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: delete
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - type: parenthesized_rule
          children:
          - type: choice
            children:
            - text: perm
              type: word
            - text: permanently
              type: word
        - text: delete
          type: word
        - type: optional
          children:
          - text: this
            type: word
        - type: optional
          children:
          - text: message
            type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: shift+delete
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: new
          type: word
        - text: folder
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: shift-e
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: mark
          type: word
        - type: optional
          children:
          - text: this
            type: word
        - type: optional
          children:
          - type: parenthesized_rule
            children:
            - type: choice
              children:
              - text: item
                type: word
              - text: message
                type: word
        - text: as
          type: word
        - text: read
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: q
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: mark
          type: word
        - type: optional
          children:
          - text: this
            type: word
        - type: optional
          children:
          - type: parenthesized_rule
            children:
            - type: choice
              children:
              - text: item
                type: word
              - text: message
                type: word
        - text: as
          type: word
        - text: unread
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: u
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: flag
          type: word
        - type: optional
          children:
          - text: this
            type: word
        - type: optional
          children:
          - type: parenthesized_rule
            children:
            - type: choice
              children:
              - text: item
                type: word
              - text: message
                type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: insert
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - text: archive
        type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: e
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: mark
          type: word
        - type: optional
          children:
          - text: this
            type: word
        - type: optional
          children:
          - text: message
            type: word
        - type: optional
          children:
          - text: as
            type: word
        - text: junk
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: j
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: moved
          type: word
        - text: to
          type: word
        - type: optional
          children:
          - text: a
            type: word
        - text: folder
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: v
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - type: seq
        children:
        - text: categorize
          type: word
        - type: optional
          children:
          - text: this
            type: word
        - text: message
          type: word
    script:
      type: block
      children:
      - type: expression
        expression:
          type: key_action
          arguments:
            text: c
            type: implicit_string
