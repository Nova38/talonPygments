input: "win.title:/repl/\nwin.title:/Talon - REPL/\n-\ntag(): user.talon_python\n\n\
  # uncomment user.talon_populate_lists tag to activate talon-specific lists of actions,\
  \ scopes, modes etcetera.\n# Do not enable this tag with dragon, as it will be unusable.\n\
  # with conformer, the latency increase may also be unacceptable depending on your\
  \ cpu\n# see https://github.com/knausj85/knausj_talon/issues/600\n# tag(): user.talon_populate_lists\n\
  \n^test last$:\n    phrase = user.history_get(1)\n    command = \"sim('{phrase}')\"\
  \n    insert(command)\n    key(enter)\n^test <phrase>$:\n    insert(\"sim('{phrase}')\"\
  )\n    key(enter)\n^test numb <number_small>$:\n    phrase = user.history_get(number_small)\n\
  \    command = \"sim('{phrase}')\"\n    #to do: shouldn't this work?\n    #user.paste(\"\
  sim({phrase})\")\n    insert(command)\n    key(enter)\n# requires user.talon_populate_lists\
  \ tag. do not use with dragon\n^debug action {user.talon_actions}$:\n    insert(\"\
  actions.find('{user.talon_actions}')\")\n    key(enter)\n# requires user.talon_populate_lists\
  \ tag. do not use with dragon\n^debug list {user.talon_lists}$:\n    insert(\"actions.user.talon_pretty_print(registry.lists['{talon_lists}'])\"\
  )\n    key(enter)\n^debug tags$:\n    insert(\"actions.user.talon_pretty_print(registry.tags)\"\
  )\n    key(enter)\n^debug settings$:\n    insert(\"actions.user.talon_pretty_print(registry.settings)\"\
  )\n    key(enter)\n^debug modes$:\n    insert(\"actions.user.talon_pretty_print(scope.get('mode'))\"\
  )\n    key(enter)\n# requires user.talon_populate_lists tag. do not use with dragon\n\
  ^debug scope {user.talon_scopes}$:\n    insert(\"actions.user.talon_pretty_print(scope.get('{talon_scopes}'))\"\
  )\n    key(enter)\n^debug running apps$:\n    insert(\"actions.user.talon_pretty_print(ui.apps(background=False))\"\
  )\n    key(enter)\n^debug all windows$:\n    insert(\"actions.user.talon_pretty_print(ui.windows())\"\
  )\n    key(enter)\n^debug {user.running} windows$:\n    insert(\"actions.user.talon_debug_app_windows('{running}')\"\
  )\n    key(enter)\n"
output:
  type: source_file
  children:
  - type: context
    children:
    - type: or
      children:
      - type: match
        key:
          text: win.title
          type: identifier
        pattern:
          text: /repl/
          type: implicit_string
      - type: match
        key:
          text: win.title
          type: identifier
        pattern:
          text: /Talon - REPL/
          type: implicit_string
  - type: include_tag
    tag:
      text: user.talon_python
      type: identifier
  - text: '# uncomment user.talon_populate_lists tag to activate talon-specific lists
      of actions, scopes, modes etcetera.'
    type: comment
  - text: '# Do not enable this tag with dragon, as it will be unusable.'
    type: comment
  - text: '# with conformer, the latency increase may also be unacceptable depending
      on your cpu'
    type: comment
  - text: '# see https://github.com/knausj85/knausj_talon/issues/600'
    type: comment
  - text: '# tag(): user.talon_populate_lists'
    type: comment
  - type: command
    rule:
      type: rule
      children:
      - text: ^
        type: start_anchor
      - type: seq
        children:
        - text: test
          type: word
        - text: last
          type: word
      - text: $
        type: end_anchor
    script:
      type: block
      children:
      - type: assignment
        left:
          text: phrase
          type: identifier
        right:
          type: action
          action_name:
            text: user.history_get
            type: identifier
          arguments:
            type: argument_list
            children:
            - text: '1'
              type: integer
      - type: assignment
        left:
          text: command
          type: identifier
        right:
          type: string
          children:
          - text: sim('
            type: string_content
          - text: '{'
            type: string_content
          - text: phrase
            type: string_content
          - text: '}'
            type: string_content
          - text: "')"
            type: string_content
      - type: expression
        expression:
          type: action
          action_name:
            text: insert
            type: identifier
          arguments:
            type: argument_list
            children:
            - type: variable
              variable_name:
                text: command
                type: identifier
      - type: expression
        expression:
          type: key_action
          arguments:
            text: enter
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - text: ^
        type: start_anchor
      - type: seq
        children:
        - text: test
          type: word
        - type: capture
          capture_name:
            text: phrase
            type: identifier
      - text: $
        type: end_anchor
    script:
      type: block
      children:
      - type: expression
        expression:
          type: action
          action_name:
            text: insert
            type: identifier
          arguments:
            type: argument_list
            children:
            - type: string
              children:
              - text: sim('
                type: string_content
              - text: '{'
                type: string_content
              - text: phrase
                type: string_content
              - text: '}'
                type: string_content
              - text: "')"
                type: string_content
      - type: expression
        expression:
          type: key_action
          arguments:
            text: enter
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - text: ^
        type: start_anchor
      - type: seq
        children:
        - text: test
          type: word
        - text: numb
          type: word
        - type: capture
          capture_name:
            text: number_small
            type: identifier
      - text: $
        type: end_anchor
    script:
      type: block
      children:
      - type: assignment
        left:
          text: phrase
          type: identifier
        right:
          type: action
          action_name:
            text: user.history_get
            type: identifier
          arguments:
            type: argument_list
            children:
            - type: variable
              variable_name:
                text: number_small
                type: identifier
      - type: assignment
        left:
          text: command
          type: identifier
        right:
          type: string
          children:
          - text: sim('
            type: string_content
          - text: '{'
            type: string_content
          - text: phrase
            type: string_content
          - text: '}'
            type: string_content
          - text: "')"
            type: string_content
      - text: "#to do: shouldn't this work?"
        type: comment
      - text: '#user.paste("sim({phrase})")'
        type: comment
      - type: expression
        expression:
          type: action
          action_name:
            text: insert
            type: identifier
          arguments:
            type: argument_list
            children:
            - type: variable
              variable_name:
                text: command
                type: identifier
      - type: expression
        expression:
          type: key_action
          arguments:
            text: enter
            type: implicit_string
  - text: '# requires user.talon_populate_lists tag. do not use with dragon'
    type: comment
  - type: command
    rule:
      type: rule
      children:
      - text: ^
        type: start_anchor
      - type: seq
        children:
        - text: debug
          type: word
        - text: action
          type: word
        - type: list
          list_name:
            text: user.talon_actions
            type: identifier
      - text: $
        type: end_anchor
    script:
      type: block
      children:
      - type: expression
        expression:
          type: action
          action_name:
            text: insert
            type: identifier
          arguments:
            type: argument_list
            children:
            - type: string
              children:
              - text: actions.find('
                type: string_content
              - text: '{'
                type: string_content
              - text: user.talon_actions
                type: string_content
              - text: '}'
                type: string_content
              - text: "')"
                type: string_content
      - type: expression
        expression:
          type: key_action
          arguments:
            text: enter
            type: implicit_string
  - text: '# requires user.talon_populate_lists tag. do not use with dragon'
    type: comment
  - type: command
    rule:
      type: rule
      children:
      - text: ^
        type: start_anchor
      - type: seq
        children:
        - text: debug
          type: word
        - text: list
          type: word
        - type: list
          list_name:
            text: user.talon_lists
            type: identifier
      - text: $
        type: end_anchor
    script:
      type: block
      children:
      - type: expression
        expression:
          type: action
          action_name:
            text: insert
            type: identifier
          arguments:
            type: argument_list
            children:
            - type: string
              children:
              - text: actions.user.talon_pretty_print(registry.lists['
                type: string_content
              - text: '{'
                type: string_content
              - text: talon_lists
                type: string_content
              - text: '}'
                type: string_content
              - text: "'])"
                type: string_content
      - type: expression
        expression:
          type: key_action
          arguments:
            text: enter
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - text: ^
        type: start_anchor
      - type: seq
        children:
        - text: debug
          type: word
        - text: tags
          type: word
      - text: $
        type: end_anchor
    script:
      type: block
      children:
      - type: expression
        expression:
          type: action
          action_name:
            text: insert
            type: identifier
          arguments:
            type: argument_list
            children:
            - type: string
              children:
              - text: actions.user.talon_pretty_print(registry.tags)
                type: string_content
      - type: expression
        expression:
          type: key_action
          arguments:
            text: enter
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - text: ^
        type: start_anchor
      - type: seq
        children:
        - text: debug
          type: word
        - text: settings
          type: word
      - text: $
        type: end_anchor
    script:
      type: block
      children:
      - type: expression
        expression:
          type: action
          action_name:
            text: insert
            type: identifier
          arguments:
            type: argument_list
            children:
            - type: string
              children:
              - text: actions.user.talon_pretty_print(registry.settings)
                type: string_content
      - type: expression
        expression:
          type: key_action
          arguments:
            text: enter
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - text: ^
        type: start_anchor
      - type: seq
        children:
        - text: debug
          type: word
        - text: modes
          type: word
      - text: $
        type: end_anchor
    script:
      type: block
      children:
      - type: expression
        expression:
          type: action
          action_name:
            text: insert
            type: identifier
          arguments:
            type: argument_list
            children:
            - type: string
              children:
              - text: actions.user.talon_pretty_print(scope.get('mode'))
                type: string_content
      - type: expression
        expression:
          type: key_action
          arguments:
            text: enter
            type: implicit_string
  - text: '# requires user.talon_populate_lists tag. do not use with dragon'
    type: comment
  - type: command
    rule:
      type: rule
      children:
      - text: ^
        type: start_anchor
      - type: seq
        children:
        - text: debug
          type: word
        - text: scope
          type: word
        - type: list
          list_name:
            text: user.talon_scopes
            type: identifier
      - text: $
        type: end_anchor
    script:
      type: block
      children:
      - type: expression
        expression:
          type: action
          action_name:
            text: insert
            type: identifier
          arguments:
            type: argument_list
            children:
            - type: string
              children:
              - text: actions.user.talon_pretty_print(scope.get('
                type: string_content
              - text: '{'
                type: string_content
              - text: talon_scopes
                type: string_content
              - text: '}'
                type: string_content
              - text: "'))"
                type: string_content
      - type: expression
        expression:
          type: key_action
          arguments:
            text: enter
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - text: ^
        type: start_anchor
      - type: seq
        children:
        - text: debug
          type: word
        - text: running
          type: word
        - text: apps
          type: word
      - text: $
        type: end_anchor
    script:
      type: block
      children:
      - type: expression
        expression:
          type: action
          action_name:
            text: insert
            type: identifier
          arguments:
            type: argument_list
            children:
            - type: string
              children:
              - text: actions.user.talon_pretty_print(ui.apps(background=False))
                type: string_content
      - type: expression
        expression:
          type: key_action
          arguments:
            text: enter
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - text: ^
        type: start_anchor
      - type: seq
        children:
        - text: debug
          type: word
        - text: all
          type: word
        - text: windows
          type: word
      - text: $
        type: end_anchor
    script:
      type: block
      children:
      - type: expression
        expression:
          type: action
          action_name:
            text: insert
            type: identifier
          arguments:
            type: argument_list
            children:
            - type: string
              children:
              - text: actions.user.talon_pretty_print(ui.windows())
                type: string_content
      - type: expression
        expression:
          type: key_action
          arguments:
            text: enter
            type: implicit_string
  - type: command
    rule:
      type: rule
      children:
      - text: ^
        type: start_anchor
      - type: seq
        children:
        - text: debug
          type: word
        - type: list
          list_name:
            text: user.running
            type: identifier
        - text: windows
          type: word
      - text: $
        type: end_anchor
    script:
      type: block
      children:
      - type: expression
        expression:
          type: action
          action_name:
            text: insert
            type: identifier
          arguments:
            type: argument_list
            children:
            - type: string
              children:
              - text: actions.user.talon_debug_app_windows('
                type: string_content
              - text: '{'
                type: string_content
              - text: running
                type: string_content
              - text: '}'
                type: string_content
              - text: "')"
                type: string_content
      - type: expression
        expression:
          type: key_action
          arguments:
            text: enter
            type: implicit_string
